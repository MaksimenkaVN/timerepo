pipeline {
//    options {
//        buildDiscarder(logRotator(numToKeepStr: '3'))
//    }
//    parameters {
//        choice choices: ['slave', 'master', 'docker_build'], description: 'Select agent', name: 'agent'
//    }
    agent any

    stages {
        stage('Test') {
            steps {
//                dir('apps/hello-world-app') {
//                    sh "mvn -B -DskipTests clean package"
//               }
// docker-compose -f ./time/time-app/docker-compose-pub.yml up -d
                sh '''                
                  ls -la
                  pwd                  
                  docker build --file ./time/time-app/frontend/Dockerfile -t maksimenkavn/time-app-frontend-dev .
                  docker build --file ./time/time-app/api/Dockerfile -t maksimenkavn/time-app-api-dev .
                  docker push maksimenkavn/time-app-api-dev
                  docker push maksimenkavn/time-app-frontend-dev
                  docker-compose -f ./time/time-app/docker-compose-pub.yml up -d
                '''
            }
        }
    }
    post {
        always {
            cleanWs()
        }
    }
}
